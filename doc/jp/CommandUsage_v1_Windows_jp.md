# Command Parameters for Windows cluster
- clpcreate コマンド **(ver1)** の使用法について説明しています。
- 各パラメータに入力可能な文字列や禁則文字列については、CLUSTERPRO のリファレンスガイドを参照してください。

## 目次
- [クラスタ構成情報ファイルの初期化](#クラスタ構成情報ファイルの初期化)
- [クラスタの追加](#クラスタの追加)
- [サーバの追加](#サーバの追加)
- [HBAの追加](#HBAの追加)
- [IPアドレスの追加](#IPアドレスの追加)
- [カーネルモードハートビートの追加](#カーネルモードハートビートの追加)
- [BMCハートビートの追加](#BMCハートビートの追加)
- [ネットワークパーティション解決リソース(PING方式)の追加](#ネットワークパーティション解決リソース(PING方式)の追加)
- [ネットワークパーティション解決リソース(ディスク方式)の追加](#ネットワークパーティション解決リソース(ディスク方式)の追加)
- [グループの追加](#グループの追加)
- [リソースの追加](#リソースの追加)
- [リソースの依存関係の追加](#リソースの依存関係の追加)
- [モニタリソースの追加](#モニタリソースの追加)

## クラスタ構成情報ファイルの初期化
```bash
$ clpcreate init <エンコード>
```
- エンコードは、CLUSTERPROの言語に応じて次の値を入力してください。
  - SJIS: 日本語
  - ASCII: 英語
  - GB2312: 中国語

## クラスタの追加
```bash
# クラスタの追加
$ clpcreate add cls <クラスタ名> <文字コード> <エンコード> <OS の種類>

# クラスタのパラメータの追加
$ clpcreate add clsparam <タグ名> <パラメータ>
```
- 文字コード: CLUSTERPRO の言語に応じて次の値を入力してください。
  - SJIS: 日本語
  - ASCII: 英語
  - GB2312: 中国語
- エンコード: WebUI で clp.conf を作成した場合に、WebUI が動くサーバの OS と CLUSTERPRO の言語により決定されるパラメータです。
  - OS が Windowsの場合: SJIS
  - OS が Linux かつ日本語の場合: EUC-JP
  - OS が Linux かつ英語の場合: ASCII
  - OS が Linux かつ中国語の場合: GB2312
- OS の種類: クラスタサーバの OS の種類を指定してください。
- タグ名、パラメータについては、[クラスタのパラメータ](#クラスタのパラメータ)を参照してください。

## サーバの追加
```bash
$ clpcreate add srv <サーバ名> <プライオリティ>
``` 
- サーバ名: クラスタのサーバ名を指定してください (e.g. hostname コマンドの実行結果)。アルファベットは小文字である必要があります。
- プライオリティ: マスタサーバが 0 になります。以降のサーバは 1 ずつインクリメントしてください。
  - 2 ノード構成 (server1, server2) で、server1 がマスタサーバの場合、server1 のプライオリティが 0、server2 のプライオリティが 1 となります。

## HBAの追加
- 作成中

## IPアドレスの追加
```bash
$ clpcreate add ip <サーバ名> <デバイスID> <IPアドレス>
```
- サーバ名: クラスタのサーバ名を指定してください。
- デバイスID: 各サーバのIPアドレスのデバイスIDを指定してください。以降のデバイスIDは 1 ずつインクリメントしてください。
  - ユーザモードハートビート、カーネルモードハートビートは 0 から始まります。
    - 例: lanhb1のデバイスIDが0, lankhb1のデバイスIDが1, lanhb2のデバイスIDが2
  - デバイスIDはサーバ毎で独立となっています。(デバイスID 0 が複数存在することになる。)
- IPアドレス: カーネルモードハートビートやユーザモードハートビートで用いるIPアドレスを指定してください。
  
## カーネルモードハートビートの追加
```bash
$ clpcreate add khb <デバイスID> <プライオリティ>
```
- デバイスID: IPアドレスのデバイスIDを指定してください。
- プライオリティ: ハートビートのプライオリティは 0 から指定してください。

## ネットワークパーティション解決リソース(PING方式)の追加
```bash
$ clpcreate add npsrv ping <サーバ名> <デバイスID> <使用の有無>
$ clpcreate add np ping <プライオリティ> <デバイスID> <グループID> <リストID> <IPアドレス>
```
- NP解決リソースを追加するには、2つのコマンドを実行する必要があります。
  - clpcreate add npsrv ping
  - clpcreate add np ping
- サーバ名: サーバ名を指定してください。
- デバイスID: NP解決リソースのデバイスIDを 10200 から指定してください。以降のデバイスは 1 ずつインクリメントしてください。
- 使用の有無: 各サーバについて、使用する場合は 1 、使用しない場合は空文字 "" を指定してください。
- プライオリティ: NP解決リソースのプライオリティは 0 から指定してください。
- グループID: NP解決リソースのグループIDを 0 から指定してください。以降のグループIDは 1 ずつインクリメントしてください。
- リストID: IPアドレスのIDを 0 から指定してください。以降のIDは 1 ずつインクリメントしてください。
- IPアドレス: NP解決リソースで用いるIPアドレスを指定してください。

## ネットワークパーティション解決リソース(ディスク方式)の追加
```bash
$ clpcreate add npsrv disk <サーバ名> <デバイスID> <GUID> <ドライブレター>
$ clpcreate add np disk <プライオリティ> <デバイスID>
```
- NP解決リソースを追加するには、2つのコマンドを実行する必要があります。
  - clpcreate add npsrv disk
  - clpcreate add np disk
- サーバ名: サーバ名を指定してください。
- デバイスID: NP解決リソースのデバイスIDを 10100 から指定してください。以降のデバイスは 1 ずつインクリメントしてください。
- GUID: GUIDを指定してください。
- ドライブレター: ドライブレターを指定してください。(例: F:\\)
- プライオリティ: NP解決リソースのプライオリティは 0 から指定してください。

## BMCハートビートの追加
```bash
$ clpcreate add bmchbsrv <サーバ名> <デバイスID> <IPアドレス>
$ clpcreate add bmchb <デバイスID> <プライオリティ>
```
- サーバ名: サーバ名を指定してください。
- デバイスID: IPアドレスのデバイスID 600 以降を指定してください。以降のデバイス ID は1ずつインクリメントしてください。
- プライオリティ: ハートビートのプライオリティは 0 から指定してください。
- IPアドレス: BMCハートビートで用いるIPアドレスを指定してください。

## グループの追加
```bash
# グループの追加
$ clpcreate add grp <グループのタイプ> <グループ名>

# グループのパラメータの追加
$ clpcreate add grpparam <グループのタイプ名> <グループ名> <タグ名> <パラメータ>
```
- グループのタイプ: 通常のグループには **failover** を指定してください。
- グループ名: グループ名を指定してください。
- タグ名、パラメータについては、[グループのパラメータ](#グループのパラメータ)を参照してください。

## リソースの追加
```bash
# リソースの追加
$ clpcreate add rsc <リソースを追加するグループ名> <リソースのタイプ名> <リソース名>

# リソースのパラメータの追加
$ clpcreate add rscparam <リソースのタイプ名> <リソース名> <タグ名> <パラメータ>
```
- リソースを追加するグループ名: リソースを追加したいグループ名を指定してください。
- リソースのタイプ名: リソースのタイプ (e.g. fip, disk, exec) を指定してください。
- リソース名: リソース名を指定してください。
- タグ名、パラメータについては、[リソースのパラメータ](#リソースのパラメータ)を参照してください。

## リソースの依存関係の追加
```bash
$ clpcreate add rscdep <依存されるリソースのタイプ> <依存されるリソース名> <依存するリソース名>
```
- グループの起動時、依存されるリソースの起動後、依存するリソースを起動します。
- グループの停止時、依存するリソースの停止後、依存されるリソースを停止します。

## モニタリソースの追加
```bash
# モニタリソースを追加する
$ clpcreate add mon <モニタリソースのタイプ名> <モニタリソース名>

# モニタリソースのパラメータを追加する
$ clpcreate add monparam <モニタリソースのタイプ名> <モニタリソース名> <タグ名> <パラメータ>
```
- モニタリソースのタイプ名: モニタリソースのタイプ名 (e.g. diskw, fipw, pidw) を指定してください。
- タグ名、パラメータについては、[モニタリソースのパラメータ](#モニタリソースのパラメータ)を参照してください。